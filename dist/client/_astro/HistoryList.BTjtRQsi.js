import{j as t}from"./jsx-runtime.D_zvdyIk.js";import{r as s}from"./index.RH_Wq4ov.js";import{T as h}from"./TrackList.-ij3SPJY.js";function N(){const[r,i]=s.useState([]),[o,p]=s.useState(!0),[n,l]=s.useState(null),[d,c]=s.useState(null);s.useEffect(()=>{x()},[]);async function x(){try{const e=await fetch("/api/history"),a=await e.json();if(!e.ok){l(a.error||"Błąd ładowania");return}i(a.requests)}catch{l("Błąd połączenia")}finally{p(!1)}}async function u(e){if(confirm("Czy na pewno chcesz usunąć tę playlistę?")){c(e);try{(await fetch("/api/history",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({request_id:e})})).ok&&i(f=>f.filter(y=>y.id!==e))}catch{}finally{c(null)}}}return o?t.jsx("p",{className:"text-gray-400",children:"Ładowanie..."}):n?t.jsx("div",{className:"bg-red-900/50 border border-red-700 text-red-200 px-4 py-3 rounded-lg",children:n}):r.length===0?t.jsxs("div",{className:"text-center py-12",children:[t.jsx("p",{className:"text-gray-400 mb-4",children:"Brak wygenerowanych playlist"}),t.jsx("a",{href:"/generate",className:"text-indigo-400 hover:text-indigo-300 transition",children:"Wygeneruj pierwszą"})]}):t.jsx("div",{className:"space-y-6",children:r.map(e=>t.jsxs("div",{className:"bg-gray-900 border border-gray-800 rounded-lg p-5 space-y-4",children:[t.jsxs("div",{className:"flex items-start justify-between gap-4",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsx("p",{className:"text-white",children:e.user_input}),t.jsxs("div",{className:"flex flex-wrap gap-2 text-xs",children:[e.inferred_emotion&&t.jsx("span",{className:"bg-indigo-900/50 text-indigo-300 px-2 py-0.5 rounded-full",children:e.inferred_emotion}),e.inferred_energy&&t.jsxs("span",{className:"bg-emerald-900/50 text-emerald-300 px-2 py-0.5 rounded-full",children:["Energia: ",e.inferred_energy,"/5"]}),e.goal&&t.jsx("span",{className:"bg-purple-900/50 text-purple-300 px-2 py-0.5 rounded-full",children:e.goal})]}),t.jsx("p",{className:"text-xs text-gray-500",children:new Date(e.created_at).toLocaleString("pl-PL")})]}),t.jsx("button",{onClick:()=>u(e.id),disabled:d===e.id,className:"text-sm text-red-400 hover:text-red-300 disabled:opacity-50 transition shrink-0",children:d===e.id?"Usuwam...":"Usuń"})]}),e.tracks&&e.tracks.length>0&&t.jsx(h,{tracks:e.tracks})]},e.id))})}export{N as default};
